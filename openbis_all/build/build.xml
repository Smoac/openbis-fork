<project name="openbis" default="dist" basedir="..">
	<import file="../../build_resources/ant/build-common.xml" />

	<property name="result.dir" value="${targets}/dist" />

	<target name="dist">
		<exec executable="ant" failonerror="true">
			<arg value="-lib"/>
			<arg value="../build_resources/lib/ecj.jar"/>
			<arg value="-f"/>
			<arg value="../openbis/build/build.xml"/>
			<arg value="dist"/>
		</exec>
		<exec executable="ant" failonerror="true">
			<arg value="-lib"/>
			<arg value="../build_resources/lib/ecj.jar"/>
			<arg value="-f"/>
			<arg value="../lims/build/build.xml"/>
			<arg value="dist"/>
		</exec>
		<copy todir="${result.dir}">
			<fileset dir="../lims/${dist}"/>
		</copy>
		<exec executable="ant" failonerror="true">
			<arg value="-lib"/>
			<arg value="../build_resources/lib/ecj.jar"/>
			<arg value="-f"/>
			<arg value="../etlserver/build/build.xml"/>
			<arg value="dist"/>
		</exec>
		<copy todir="${result.dir}">
			<fileset dir="../etlserver/${dist}"/>
		</copy>
		<exec executable="ant" failonerror="true">
			<arg value="-lib"/>
			<arg value="../build_resources/lib/ecj.jar"/>
			<arg value="-f"/>
			<arg value="../dataset_download/build/build.xml"/>
			<arg value="dist"/>
		</exec>
		<copy todir="${result.dir}">
			<fileset dir="../dataset_download/${dist}"/>
		</copy>
	</target>

	<target name="clean">
		<delete dir="${dist}" />
		<exec executable="ant" failonerror="true">
			<arg value="-lib"/>
			<arg value="../build_resources/lib/ecj.jar"/>
			<arg value="-f"/>
			<arg value="../openbis/build/build.xml"/>
			<arg value="clean"/>
		</exec>
		<exec executable="ant" failonerror="true">
			<arg value="-lib"/>
			<arg value="../build_resources/lib/ecj.jar"/>
			<arg value="-f"/>
			<arg value="../lims/build/build.xml"/>
			<arg value="clean"/>
		</exec>
		<exec executable="ant" failonerror="true">
			<arg value="-lib"/>
			<arg value="../build_resources/lib/ecj.jar"/>
			<arg value="-f"/>
			<arg value="../etlserver/build/build.xml"/>
			<arg value="clean"/>
		</exec>
		<exec executable="ant" failonerror="true">
			<arg value="-lib"/>
			<arg value="../build_resources/lib/ecj.jar"/>
			<arg value="-f"/>
			<arg value="../dataset_download/build/build.xml"/>
			<arg value="clean"/>
		</exec>
	</target>

</project>