import _ from 'lodash'
import React from 'react'
import TextField from '../../common/form/TextField.jsx'
import { withStyles } from '@material-ui/core/styles'
import logger from '../../../common/logger.js'

const styles = theme => ({
  container: {
    marginBottom: theme.spacing(2)
  }
})

class ObjectTypePreviewCode extends React.PureComponent {
  constructor(props) {
    super(props)
    this.state = {
      value: ''
    }
    this.handleChange = this.handleChange.bind(this)
  }

  handleChange(event) {
    this.setState({
      value: event.target.value
    })
  }

  render() {
    logger.log(logger.DEBUG, 'ObjectTypePreviewCode.render')

    const { classes } = this.props

    return (
      <div className={classes.container}>
        <TextField
          label='Code'
          value={this.getValue()}
          disabled={this.getDisabled()}
          onChange={this.handleChange}
        />
      </div>
    )
  }

  getValue() {
    let { type } = this.props
    return type.autoGeneratedCode ? type.generatedCodePrefix : this.state.value
  }

  getDisabled() {
    let { type } = this.props
    return type.autoGeneratedCode
  }
}

export default _.flow(withStyles(styles))(ObjectTypePreviewCode)
