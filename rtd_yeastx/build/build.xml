<project name="yeastx" default="jar" basedir="..">
	<import file="../../build_resources/ant/build-common.xml" />
	<project-classpath name="ecp" classes="${classes}" />

	<property name="original.dist" value="dist" />
	<property name="mainfolder" value="rtd_yeastx" />
	<property name="nativeroot" value="${targets}/ant" />
	<property name="jar.file" value="${dist}/datastore_server-plugins.jar" />
	<property name="libraries" value="../libraries" />

	<target name="clean">
		<delete dir="${dist}" />
	</target>

	<target name="compile" depends="build-common.compile, clean" />

	<target name="jar" depends="compile">
		<mkdir dir="${dist}" />
		<build-info revision="revision.number" version="version.number" clean="clean.flag" />
		<echo file="${build.info.file}">${version.number}:${revision.number}:${clean.flag}</echo>
		<unjar src="${libraries}/eodsql/eodsql.jar"
		       dest="${classes}">
		    <patternset>
		        <exclude name="META-INF"/>
		    </patternset>
		</unjar>
		<recursive-jar destfile="${jar.file}">
			<fileset dir="${classes}">
				<include name="net/lemnik/eodsql/**" />
				<include name="ch/systemsx/cisd/yeastx/**/*.class" />
				<include name="${build.info.filename}" />
			</fileset>
			<fileset dir="source">
				<include name="**/*.sql" />
			</fileset>	
		</recursive-jar>
	</target>

	<target name="run-tests">
		<antcall target="build-common.run-tests">
			<param name="test.suite" value="tests.xml" />
		</antcall>
	</target>

      <!--
      // Task for continuous integration server.
      -->
      <target name="ci" depends="build-common.ci, check-dependencies, jar"/>
</project>