<project name="rtd_yeastx" default="dist" basedir="..">
	<import file="../../datastore_server/build/build.xml" />
	<import file="../../openbis/build/build.xml" />
	<project-classpath name="ecp" classes="${classes}" />

	<property name="variant" value="-yeastx" />
	<property name="original.dist" value="dist" />
	<property name="mainfolder" value="rtd_yeastx" />
	<property name="nativeroot" value="${targets}/ant" />

	<target name="compile" depends="build-common.compile, clean" />

	<target name="dist" depends="jar" >
		<copy todir="${dist.datastore_server.lib}">
			<fileset dir="${lib}/jfreechart" >
				<include name="*.jar"/>
			</fileset>
		</copy>
		<antcall target="datastore_server.make-plugin-dist"/>
	</target>
	
	<target name="jar" depends="compile">
		<mkdir dir="${dist}" />
		<build-info revision="revision.number" version="version.number" clean="clean.flag" />
		<echo file="${build.info.file}">${version.number}:${revision.number}:${clean.flag}</echo>
		<jar destfile="${plugin-jar.file}">
			<fileset dir="${classes}">
				<include name="ch/systemsx/cisd/openbis/dss/yeastx/server/*.class" />
				<include name="ch/systemsx/cisd/yeastx/**/*.class" />
				<include name="${build.info.filename}" />
			</fileset>
			<fileset dir="source">
				<include name="**/*.sql" />
			</fileset>	
			<fileset dir="source/java">
				<include name="**/*.xsd" />
			</fileset>	
			<manifest>
				<attribute name="Main-Class" value="ch.systemsx.cisd.yeastx.BuildAndEnvironmentInfo" />
				<attribute name="Version" value="${version.number}" />
				<attribute name="Build-Number"
				           value="${version.number} (r${revision.number},${clean.flag})" />
			</manifest>
		</jar>
	</target>

      <!--
      // Task for continuous integration server.
      -->
      <target name="ci" depends="build-common.ci, dist, check-dependencies"/>
</project>