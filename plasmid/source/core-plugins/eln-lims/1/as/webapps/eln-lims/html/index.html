<!--
/*
 * Copyright 2014 ETH Zuerich, Scientific IT Services
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<title>ELN Browser</title>
	
	<!-- Third party Stylesheets -->
	<link type="text/css" rel="stylesheet" href="./lib/bootstrap/css/bootstrap.min.css" />
	<link type="text/css" rel="stylesheet" href="./lib/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" />
	<link type="text/css" rel="stylesheet" href="./lib/bootstrap-multiselect/css/bootstrap-multiselect.css" />
	<link type="text/css" rel="stylesheet" href="./lib/bootstrap-slider/css/bootstrap-slider.css" />
	<link type="text/css" rel="stylesheet" href="./lib/bootstrap-switch/css/toggle-switch.css" />
	<link type="text/css" rel="stylesheet" href="./lib/jquery-jnotify/css/jNotify.sis.jquery.css" />
	<link type="text/css" rel="stylesheet" href="./lib/jquery-tooltipster/css/tooltipster.css" />
	<link type="text/css" rel="stylesheet" href="./lib/fuelux/css/fuelux.min.css" />
	<link type="text/css" rel="stylesheet" href="./lib/drawingboard/css/drawingboard.min.css" />
	<link type="text/css" rel="stylesheet" href="./lib/jquery-fancytree/js/skin-bootstrap/ui.fancytree.min.css" />
	<link type="text/css" rel="stylesheet" href="./lib/summernote/css/summernote.css" />
	<link type="text/css" rel="stylesheet" href="./lib/font-awesome/css/font-awesome.min.css" />
	
	<!-- ELN UI Stylesheets -->
	<link type="text/css" rel="stylesheet" href="./css/style.css" />
	
	<!-- Third party libraries -->
	<script type="text/javascript" src="./lib/jquery/js/jquery-1.11.3.min.js"></script>
	<script type="text/javascript" src="./lib/jquery-ui/js/jquery-ui.min.js"></script>
	<script type="text/javascript" src="./lib/jquery-fancytree/js/jquery.fancytree-all.min.js"></script>
	<script type="text/javascript" src="./lib/bootstrap-datetimepicker/js/moment.js"></script>
	<script type="text/javascript" src="./lib/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="./lib/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
	<script type="text/javascript" src="./lib/bootstrap-multiselect/js/bootstrap-multiselect.js"></script>
	<script type="text/javascript" src="./lib/bootstrap-slider/js/bootstrap-slider.js"></script>
	<script type="text/javascript" src="./lib/bootstrap-filestyle/js/bootstrap-filestyle.min.js"></script>
	<script type="text/javascript" src="./lib/jquery-jnotify/js/jNotify.sis.jquery.js"></script>
	<script type="text/javascript" src="./lib/jquery-blockui/js/jquery.blockUI.js"></script>
	<script type="text/javascript" src="./lib/jquery-history/js/bundled/html5/jquery.history.js"></script>
	<script type="text/javascript" src="./lib/jquery-tooltipster/js/jquery.tooltipster.min.js"></script>
	<script type="text/javascript" src="./lib/jquery-tsv/js/jquery.tsv-0.96.min.js"></script>
	<script type="text/javascript" src="./lib/fuelux/js/fuelux.min.js"></script>
	<script type="text/javascript" src="./lib/d3/js/d3.min.js"></script>
	<script type="text/javascript" src="./lib/d3-dagre/js/dagre-d3.min.js"></script>
	<script type="text/javascript" src="./lib/naturalsort/js/naturalSort.js"></script>
	<script type="text/javascript" src="./lib/mozilla/js/infra.js"></script>
	<script type="text/javascript" src="./lib/filesaver/js/FileSaver.js"></script>
	<script type="text/javascript" src="./lib/drawingboard/js/drawingboard.min.js"></script>
	<script type="text/javascript" src="./lib/summernote/js/summernote.min.js"></script>
	<script type="text/javascript" src="./lib/summernote/js/summernote.ext.specialchars.js"></script>
	<script type="text/javascript" src="./lib/caja-HTML-sanitizer/js/lib/html4.js"></script>
	<script type="text/javascript" src="./lib/caja-HTML-sanitizer/js/lib/uri.js"></script>
	<script type="text/javascript" src="./lib/caja-HTML-sanitizer/js/sanitizer.js"></script>
	
	<!-- First party libraries -->
	<script type="text/javascript" src="./lib/openbis/js/v1/openbis.js"></script>
	<script type="text/javascript" src="./lib/openbis/js/v3/config.js"></script>
	<script type="text/javascript" src="./lib/openbis/js/v3/require.js"></script>
	<script type="text/javascript" src="./lib/grid/js/Grid.js"></script>
	
	<!-- ELN UI -->
	<script type="text/javascript" src="./js/controllers/MainController.js"></script>
	
	<script type="text/javascript" src="./js/config/Profile.js"></script>
	<script type="text/javascript" src="./js/config/StandardProfile.js"></script>
	<!-- <PROFILE_JS_PLACEHOLDER>-->
	
	<!--</PROFILE_JS_PLACEHOLDER>-->
	
	<script type="text/javascript" src="./js/server/ServerFacade.js"></script>
	
	<script type="text/javascript" src="./js/util/Util.js"></script>
	<script type="text/javascript" src="./js/util/FormUtil.js"></script>
	<script type="text/javascript" src="./js/util/BlockScrollUtil.js"></script>
	<script type="text/javascript" src="./js/util/PrintUtil.js"></script>
	<script type="text/javascript" src="./js/util/AnnotationUtil.js"></script>
	<script type="text/javascript" src="./js/util/HierarchyUtil.js"></script>
	
	<script type="text/javascript" src="./js/views/TrashManager/TrashManagerController.js"></script>
	<script type="text/javascript" src="./js/views/TrashManager/TrashManagerModel.js"></script>
	<script type="text/javascript" src="./js/views/TrashManager/TrashManagerView.js"></script>
	
	<script type="text/javascript" src="./js/views/StorageManager/StorageManagerController.js"></script>
	<script type="text/javascript" src="./js/views/StorageManager/StorageManagerModel.js"></script>
	<script type="text/javascript" src="./js/views/StorageManager/StorageManagerView.js"></script>
	<script type="text/javascript" src="./js/views/StorageManager/widgets/StorageController.js"></script>
	<script type="text/javascript" src="./js/views/StorageManager/widgets/StorageModel.js"></script>
	<script type="text/javascript" src="./js/views/StorageManager/widgets/StorageView.js"></script>
	<script type="text/javascript" src="./js/views/StorageManager/widgets/GridController.js"></script>
	<script type="text/javascript" src="./js/views/StorageManager/widgets/GridModel.js"></script>
	<script type="text/javascript" src="./js/views/StorageManager/widgets/GridView.js"></script>

	<script type="text/javascript" src="./js/views/DataGrid/SampleDataGridUtil.js"></script>
	<script type="text/javascript" src="./js/views/DataGrid/DataGridController.js"></script>
	<script type="text/javascript" src="./js/views/DataGrid/DataGridModel.js"></script>
	<script type="text/javascript" src="./js/views/DataGrid/DataGridView.js"></script>
	
	<script type="text/javascript" src="./js/views/SampleForm/SampleFormController.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/SampleFormModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/SampleFormView.js"></script>
	
	<script type="text/javascript" src="./js/views/AdvancedSearch/AdvancedSearchController.js"></script>
	<script type="text/javascript" src="./js/views/AdvancedSearch/AdvancedSearchModel.js"></script>
	<script type="text/javascript" src="./js/views/AdvancedSearch/AdvancedSearchView.js"></script>
	
	<script type="text/javascript" src="./js/views/SampleForm/widgets/StorageListController.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/StorageListModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/StorageListView.js"></script>
	
	<script type="text/javascript" src="./js/views/SampleForm/widgets/DilutionTableController.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/DilutionTableModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/DilutionTableView.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/FreeFormTableController.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/FreeFormTableModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/FreeFormTableView.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/DeleteEntityController.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/DeleteEntityModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/DeleteEntityView.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/CommentsController.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/CommentsModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/CommentsView.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/PlateController.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/PlateModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/PlateView.js"></script>
	
	<script type="text/javascript" src="./js/views/SampleForm/widgets/LinksController.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/LinksModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleForm/widgets/LinksView.js"></script>
	
	<script type="text/javascript" src="./js/views/SpaceForm/SpaceFormController.js"></script>
	<script type="text/javascript" src="./js/views/SpaceForm/SpaceFormModel.js"></script>
	<script type="text/javascript" src="./js/views/SpaceForm/SpaceFormView.js"></script>
	
	<script type="text/javascript" src="./js/views/ProjectForm/ProjectFormController.js"></script>
	<script type="text/javascript" src="./js/views/ProjectForm/ProjectFormModel.js"></script>
	<script type="text/javascript" src="./js/views/ProjectForm/ProjectFormView.js"></script>
	
	<script type="text/javascript" src="./js/views/ExperimentForm/ExperimentFormController.js"></script>
	<script type="text/javascript" src="./js/views/ExperimentForm/ExperimentFormModel.js"></script>
	<script type="text/javascript" src="./js/views/ExperimentForm/ExperimentFormView.js"></script>
	
	<script type="text/javascript" src="./js/views/UserManager/UserManagerController.js"></script>
	<script type="text/javascript" src="./js/views/UserManager/UserManagerModel.js"></script>
	<script type="text/javascript" src="./js/views/UserManager/UserManagerView.js"></script>
	<script type="text/javascript" src="./js/views/UserManager/modal/CreateUserController.js"></script>
	<script type="text/javascript" src="./js/views/UserManager/modal/CreateUserModel.js"></script>
	<script type="text/javascript" src="./js/views/UserManager/modal/CreateUserView.js"></script>
	<script type="text/javascript" src="./js/views/UserManager/modal/ResetPasswordController.js"></script>
	<script type="text/javascript" src="./js/views/UserManager/modal/ResetPasswordModel.js"></script>
	<script type="text/javascript" src="./js/views/UserManager/modal/ResetPasswordView.js"></script>
	
	<script type="text/javascript" src="./js/views/DataSetForm/DataSetFormController.js"></script>
	<script type="text/javascript" src="./js/views/DataSetForm/DataSetFormModel.js"></script>
	<script type="text/javascript" src="./js/views/DataSetForm/DataSetFormView.js"></script>
	
	<script type="text/javascript" src="./js/views/DataSetForm/widgets/DatasetViewerController.js"></script>
	<script type="text/javascript" src="./js/views/DataSetForm/widgets/DatasetViewerModel.js"></script>
	<script type="text/javascript" src="./js/views/DataSetForm/widgets/DatasetViewerView.js"></script>
	
	<script type="text/javascript" src="./js/views/SideMenu/SideMenuWidgetController.js"></script>
	<script type="text/javascript" src="./js/views/SideMenu/SideMenuWidgetModel.js"></script>
	<script type="text/javascript" src="./js/views/SideMenu/SideMenuWidgetView.js"></script>
	
	<script type="text/javascript" src="./js/views/VocabularyManager/VocabularyManagerController.js"></script>
	<script type="text/javascript" src="./js/views/VocabularyManager/VocabularyManagerModel.js"></script>
	<script type="text/javascript" src="./js/views/VocabularyManager/VocabularyManagerView.js"></script>
	
	<script type="text/javascript" src="./js/views/SampleHierarchyTable/SampleHierarchyTableController.js"></script>
	<script type="text/javascript" src="./js/views/SampleHierarchyTable/SampleHierarchyTableModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleHierarchyTable/SampleHierarchyTableView.js"></script>
	<script type="text/javascript" src="./js/views/SampleHierarchyTable/widgets/HierarchyFilterController.js"></script>
	<script type="text/javascript" src="./js/views/SampleHierarchyTable/widgets/HierarchyFilterModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleHierarchyTable/widgets/HierarchyFilterView.js"></script>
	
	<script type="text/javascript" src="./js/views/SampleTable/SampleTableController.js"></script>
	<script type="text/javascript" src="./js/views/SampleTable/SampleTableModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleTable/SampleTableView.js"></script>
	<script type="text/javascript" src="./js/views/SampleTable/widgets/TypeAndFileController.js"></script>
	<script type="text/javascript" src="./js/views/SampleTable/widgets/TypeAndFileModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleTable/widgets/TypeAndFileView.js"></script>
	<script type="text/javascript" src="./js/views/SampleTable/widgets/MoveSampleController.js"></script>
	<script type="text/javascript" src="./js/views/SampleTable/widgets/MoveSampleModel.js"></script>
	<script type="text/javascript" src="./js/views/SampleTable/widgets/MoveSampleView.js"></script>
	
	<script type="text/javascript" src="./js/views/legacy/SampleLinksWidget.js"></script>
	<script type="text/javascript" src="./js/views/legacy/SampleHierarchy.js"></script>
	
	<script type="text/javascript" src="./js/views/DrawingBoards/DrawingBoardsController.js"></script>
	<script type="text/javascript" src="./js/views/DrawingBoards/DrawingBoardsModel.js"></script>
	<script type="text/javascript" src="./js/views/DrawingBoards/DrawingBoardsView.js"></script>
	
	<script type="text/javascript" src="./js/views/DataGrid/ExperimentDataGridUtil.js"></script>
	<script type="text/javascript" src="./js/views/ExperimentTable/ExperimentTableController.js"></script>
	<script type="text/javascript" src="./js/views/ExperimentTable/ExperimentTableModel.js"></script>
	<script type="text/javascript" src="./js/views/ExperimentTable/ExperimentTableView.js"></script>
	
	<script type="text/javascript">
	//
	// Configurations Available (Available under the js/config folder)
	// Use StandardProfile as a standard default for new installations.
	// Use ExampleProfile as a start point to develop new profiles.
	//
	
	//<PROFILE_PLACEHOLDER>
	var profile = new StandardProfile();
	//</PROFILE_PLACEHOLDER>
	
	//
	// Global variables
	//
	var mainController = new MainController(profile);
	
	//
	// Global links handler - This function avoid normal link behaviour for javascript enabled links that will use ajax calls for left clicks, allowing to open them on a new tab with right click.
	//
	$(document).click(function(e) {
		var elementClasses = $(e.target).attr('class');
		var isLeftClick = e.which === 1;
		if(isLeftClick && elementClasses && elementClasses.indexOf("browser-compatible-javascript-link") !== -1) {
			e.preventDefault();
			e.stopPropagation();
		}
	});
	
	//
	// Application Startup
	//
	$(document).ready(function() {
		$(document).ajaxError(function( event, jqxhr, settings, thrownError ) {
			try {
				Util.showError("AJAX Error status: " + jqxhr.status + " - Status text: " + jqxhr.statusText + " - Calling: " + settings.url + " - With Data: " + settings.data);
			} catch(err) {
				Util.showError("Unknown AJAX Error");
			}
		});
		
		$('#main').hide();
		var username = $("#username").value;
		if(username == null || username.length==0) {
			$("#username").focus();
		} else {
			$("#login-button").focus();
		}
	
		$('#login-form').submit(function() {
			Util.blockUI();
			var username = $('#username').val();
			var password = $('#password').val();
			
			mainController.serverFacade.login(
					$.trim($('#username').val()), 
					$.trim($('#password').val()), 
					function(data) { mainController.enterApp(data, username, password) });
		});
		
		mainController.serverFacade.ifRestoredSessionActive(function(data) { mainController.enterApp(data) });
		
		// Make the ENTER key the default button
		$("login-form input").keypress(function (e) {
			if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {
				$('button[type=submit].default').click();
				return false;
			} else {
				return true;
			}
		});
		
		//Automatic login if special parameters are given
		var queryString = Util.queryString();
		var user = queryString.user;
		var pass = queryString.pass;
		if(user && pass) {
			Util.blockUI();
			mainController.serverFacade.login(user, pass, function(data) { mainController.enterApp(data) });
		}
		
		//Resize the menu on drag
		var dragContainerFunc = function(e) {
		    var menu = $('#sideMenu');
		    var main = $('#mainContainer');
		    var mouseX = e.pageX;
		    var windowWidth = window.outerWidth;
		    var mainWidth = windowWidth - mouseX;
		    menu.css("width", mouseX + "px");
		    main.css("width", mainWidth + "px");
		    main.css("left", mouseX);
	    };
	    
		$("#dragContainer").draggable({
		    drag: dragContainerFunc
		});
		
		dragContainerFunc({ pageX : (window.outerWidth * 0.2) });
		
	});
	</script>
</head>
<body class="bodyLogin">
	<div id="login-form-div" class="loginForm">
			<img class="loginLogo" src="./img/openBIS_Logo.png" alt="openBIS" />
			<h1>Lab Notebook</h1>
			
			<form id="login-form" action="javascript:">
				<fieldset>
						<div class='loginInputBox'>
							<input placeholder="Account" id="username" type="text" required="required">
						</div>
					
						<div class='loginInputBox'>
							<input placeholder="Password" id="password" type="password" required="required">
						</div>
					
						<button class="btn btn-default" id="login-button" type="submit"><span class="glyphicon glyphicon-arrow-right"></span></button>
				</fieldset>
			</form>
			
			<center>
				<div style="margin-bottom: 5px;">Compatible With:</div>
				<img src="./img/browser-icon-chrome.png" style="width: 43px; height:43px;" /><img src="./img/browser-icon-safari.png" style="width: 43px; height:43px;" /><img src="./img/browser-icon-firefox.png" style="width: 43px; height:43px;" /><img src="./img/browser-icon-ie10.png" style="width: 43px; height:43px;" /><img src="./img/browser-icon-tablet.png" style="height:43px;" />
			</center>
	</div>
	
	<!--  div id="main">
		<div class="container">
			<div class="row">
				<div class="col-md-2" id ="sideMenu" style="top:0px; left:0px; min-height:100%; padding:0px;  border-color: #E7E7E7; border-style:solid; border-width:1px;"></div>
				<div class="col-md-10" id ="mainContainer"></div>
			</div>
		</div>
	</div -->
	
	<div id="main">
		<div class="container">
			<div class="row">
				<div id ="sideMenu"  class="col-md-2" style="float:left; top:0px; left:0px; min-height:100%; padding:0px; border-color: #E7E7E7; border-style:solid; border-width:1px;"></div>
				<div id ="dragContainer" style="background-color: red; z-index:10000; width:20px; height:100%; position:absolute; left: 20%; top:0px; float:left; cursor: col-resize;">&nbsp;</div>
				<div id ="mainContainer" class="col-md-10" style="position:absolute; left:20%; float:left;"></div>
			</div>
		</div>
	</div>
	
	
</body>
</html>



