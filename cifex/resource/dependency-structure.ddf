#show allResults

{package} = ch.systemsx.cisd.cifex
{shared} = ${package}.shared
{client} = ${package}.client
{rpc} = ${package}.rpc
{server} = ${package}.server
{business} = ${server}.business

######################################################################
# Check dependencies between main packages

[shared] = ${shared}.*
[client] = ${client}.*
[server] = ${server}.*
[server+client] = [server] [client]
[rpc] = ${rpc}.*
check sets [shared] [server+client] [client] [rpc]

layer main0 = [shared]
layer main1 = [server+client]
layer main2 = [rpc]
check layeringOf main0 main1

check [rpc] independentOf [client]
check [client] independentOf [server]

######################################################################
# Check dependencies between server and client package

[server.business] = ${business}.*
[server.common] = ${server}.common.*
[server-business-common] = ${server}.* excluding [server.business] [server.common]
check sets [server.business] [server-business-common] [server.common]

[client.application] = ${client}.application.*
[client.dto] = ${client}.dto.*
[client-application] = ${client}.* excluding [client.application]
check sets [client.application] [client.dto] [client-application]

layer layer2 = [server-business-common] [client.application]
layer layer1 = [server.business] [client-application]
layer layer0 = [server.common]

check layeringOf layer0 layer1 layer2

######################################################################
# Check dependencies in business layer

[dataaccess.db] = ${business}.dataaccess.db.*
[dataaccess-db] = ${business}.dataaccess.* excluding [dataaccess.db]
[dto] = ${business}.dto.*
[plainBusiness] = ${business}.* excluding ${business}.*.*
check sets [dataaccess.db] [dataaccess-db] [dto] [plainBusiness]

layer business-layer3 = [plainBusiness] [dataaccess.db]
layer business-layer2 = [dataaccess-db]
layer business-layer1 = [dto]

check layeringOf business-layer1 business-layer2 business-layer3

######################################################################
# Check dependencies package rpc

[rpc.common] = [rpc] excluding ${rpc}.*.*
[rpc.client] = ${rpc}.client.* excluding ${rpc}.client.gui.FileUploadClient
[rpc.server] = ${rpc}.server.*
check sets [rpc.common] [rpc.client] [rpc.server]

check [rpc.common] [rpc.client] independentOf ${server}.*

layer rpc-common = [rpc.common]
layer rpc-client-server = [rpc.client] [rpc.server]

check layeringOf rpc-common rpc-client-server 
